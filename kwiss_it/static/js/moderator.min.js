let m="",u="",d="";const g=document.getElementById("accordioncat");let p=new Map;function e(){t(),n(),i()}function t(){fetch(api_url+"/questiontype").then(e=>e.json().then(t=>{for(let e=0;e<t.length;e++)p.set(t[e].QTid,t[e].QTdescription)}))}function n(){let e=document.getElementById("templateanswer");d=e.innerHTML,e.remove();let t=document.getElementById("templateaccordionitemquestion");u=t.innerHTML,t.remove();let n=document.getElementById("templateaccordionitemclass");m=n.innerHTML,n.remove()}function i(e=api_url+"/category/?approved=true&pending=true&denied=true"){fetch(e).then(e=>e.json().then(e=>{var t=e.next;let s=e.results;if(s){for(let l=0;l<s.length;l++){let e=document.createElement("div");e.innerHTML=m,e.classList.add("accordion-item"),g.appendChild(e);let t=document.getElementById("accordionheader"),n=document.getElementById("collapseOne");t.id="accordionheader"+l.toString(),t.setAttribute("data-bs-target","#collapseOne"+l.toString()),n.id="collapseOne"+l.toString();let d=document.getElementById("catname"),i=document.getElementById("catdesc"),o=document.getElementById("catstate"),r=document.getElementById("promote"),c=document.getElementById("demote");d.innerHTML=s[l].Cname,d.id="catname"+l.toString(),i.innerHTML=s[l].Cdescription,i.id="catdesc"+l.toString(),o.innerHTML=1===s[l].STid?"approved":2===s[l].STid?"denied":"pending",o.id="catstate"+l.toString(),r.innerHTML=1===s[l].STid?"pending":"approved",r.id="promote"+l.toString(),c.innerHTML=3===s[l].STid?"pending":"denied",r.value=1===s[l].STid?"approved":2===s[l].STid?"denied":"pending",c.value=1===s[l].STid?"approved":2===s[l].STid?"denied":"pending",r.addEventListener("click",e=>{T(e,"category",s[l].Cid)}),c.addEventListener("click",e=>{T(e,"category",s[l].Cid)});let a=document.getElementById("accordionquestions");a.id="accordionquestions"+l.toString(),y(l.toString(),s[l].Cid)}null!=t&&i(t)}}))}function y(g,e){url=api_url+"/question/?approved=true&pending=true&denied=true&cid="+e.toString(),fetch(url).then(e=>e.json().then(m=>{for(let s=0;s<m.length;s++){let e=document.getElementById("accordionquestions"+g),t=document.createElement("div");t.classList.add("accordion-item"),t.innerHTML=u,e.appendChild(t);let n=document.getElementById("accordionheaderquestion"),d=document.getElementById("collapseInner");n.id="category"+g+"accordionheaderquestion"+s.toString(),n.setAttribute("data-bs-target","#category"+g+"collapseInner"+s.toString()),d.id="category"+g+"collapseInner"+s.toString(),d.setAttribute("data-bs-parent","#accordionquestions"+g);let i=document.getElementById("question"),o=document.getElementById("questiontype"),r=document.getElementById("questionstate"),c=document.getElementById("qpromote"),a=document.getElementById("qdemote");i.id="category"+g+"question"+s.toString(),i.innerHTML=m[s].Qtext,o.id="category"+g+"questiontype"+s.toString(),o.innerHTML=p.get(m[s].QTid),r.id="category"+g+"questionstate"+s.toString(),r.innerHTML=1===m[s].STid?"approved":2===m[s].STid?"denied":"pending",c.id="category"+g+"qpromote"+s.toString(),c.innerHTML=1===m[s].STid?"pending":"approved",c.value=3===m[s].STid?"pending":"denied",a.id="category"+g+"qdemote"+s.toString(),a.innerHTML=3===m[s].STid?"pending":"denied",a.value=3===m[s].STid?"pending":"denied",c.addEventListener("click",e=>{T(e,"question",m[s].Qid)}),a.addEventListener("click",e=>{T(e,"question",m[s].Qid)});let l=document.getElementById("answers");l.id="category"+g+"answers"+s.toString(),S(g,s.toString(),m[s].Qid)}}))}function S(r,c,e){e=api_url+"/answer/?qid="+e.toString();fetch(e).then(e=>e.json().then(i=>{let o=document.getElementById("category"+r+"answers"+c);for(let d=0;d<i.length;d++){let e=document.createElement("tr"),t=document.createElement("td"),n=document.createElement("td");t.id="c"+r+"q"+c+"answer"+d.toString(),t.innerHTML=i[d].Atext,n.id="c"+r+"q"+c+"correct"+d.toString(),e.appendChild(t),e.appendChild(n),o.appendChild(e)}}))}function T(e,t,n){e.disabled=!0;e=e.currentTarget;postVote(base_url+"/state/"+t+"/"+n+"/"+e.value)}async function o(e=""){const t=await fetch(e,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json","X-CSRFToken":document.getElementsByName("csrfmiddlewaretoken")[0].value},credentials:"same-origin",redirect:"follow",referrerPolicy:"no-referrer",body:""});return t.json()}document.addEventListener("DOMContentLoaded",e);