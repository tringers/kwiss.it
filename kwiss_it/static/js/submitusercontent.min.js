let i=document.getElementById("category"),e=document.getElementById("createcat"),l=document.getElementById("questionamount"),t=document.getElementById("addquestion"),m=document.getElementById("questions"),s,c,g=new Set,v=0,S=JSON;function n(){d(),r(),o()}function r(e=api_url+"/category/?approved=true&pending=true"){fetch(e).then(e=>e.json().then(e=>{var t=e.next,n=e.results;if(n){for(let t=0;t<n.length;t++){let e=document.createElement("option");e.value=n[t].Cid,e.innerText=n[t].Cname,i.appendChild(e)}null!=t&&r(t)}}))}function o(){url=api_url+"/questiontype/",fetch(url).then(e=>e.json().then(e=>{S=e}))}function d(){let e=document.getElementById("template");s=e.innerHTML,e.remove();let t=document.getElementById("templateanswer");c=t.innerHTML,t.remove()}function u(){v+=1,g.add(v);let e=document.createElement("div");e.id="q"+v.toString(),e.innerHTML=s,e.classList.add("border","row","col-lg-8","mx-auto","p-3"),m.appendChild(e);let t=document.getElementById("questionnumber"),n=document.getElementById("questionnumberfield"),d=document.getElementById("qtype"),i=document.getElementById("answeramount"),r=document.getElementById("answeramountfield"),o=document.getElementById("questiontext"),u=document.getElementById("answers"),a=document.getElementById("removequestion");t.innerText="Frage Nummer "+v.toString(),t.id="questionnumber"+v.toString(),t.name="questionnumber"+v.toString(),n.id="questionnumberfield"+v.toString(),n.name="questionnumberfield",n.value=v.toString();for(let t=0;t<S.length;t++){let e=document.createElement("option");e.value=S[t].QTname,e.innerText=S[t].QTdescription,d.appendChild(e)}d.id="qtype"+v.toString(),d.name="qtype"+v.toString(),d.addEventListener("change",function(){"single"==d.value||"multiple"==d.value?(i.removeAttribute("hidden"),r.value=i.value):(i.setAttribute("hidden","true"),r.value="1"),r.dispatchEvent(new Event("change"))}),i.id="answeramount"+v.toString(),"single"==d.value||"multiple"==d.value?(i.removeAttribute("hidden"),r.value=i.value):(i.setAttribute("hidden","true"),r.value="1"),i.addEventListener("change",function(){r.value=i.value,r.dispatchEvent(new Event("change"))}),r.addEventListener("change",function(){u.innerHTML="";var e=parseInt(r.value);for(let o=0;o<e;o++){let e=document.createElement("div");e.innerHTML=c,u.appendChild(e),e.id="question"+v.toString()+"answer"+o.toString(),e.classList.add("border","row","col-lg-10","mx-auto","p-3","rounded");let t=document.getElementById("answernumber"),n=document.getElementById("answernumberfield"),i=document.getElementById("answertext"),r=document.getElementById("correct");t.innerText="Antwort "+(o+1).toString(),t.id="question"+v.toString()+"answernumber"+o.toString(),n.id="question"+v.toString()+"answernumberfield"+o.toString(),n.name="question"+v.toString()+"answernumberfield"+o.toString(),n.value=o.toString(),i.id="question"+v.toString()+"answertext"+o.toString(),i.name="question"+v.toString()+"answertext"+o.toString(),r.id="question"+v.toString()+"correct"+o.toString(),"multiple"==d.value?r.name="question"+v.toString()+"correct"+o.toString():"number_exact"==d.value|"number_deviation"==d.value?(r.name="question"+v.toString()+"correct",r.type="radio",i.type="number"):(r.name="question"+v.toString()+"correct",r.type="radio")}}),u.id="answers"+v.toString(),r.dispatchEvent(new Event("change")),r.id="answeramountfield"+v.toString(),r.name="answeramountfield"+v.toString(),o.id="questiontext"+v.toString(),o.name="questiontext"+v.toString(),a.id="removequestion"+v.toString(),a.addEventListener("click",function(){g.delete(e.name.substring(1)),l.value=g.size.toString(),e.remove()}),l.value=g.size.toString()}i.addEventListener("change",function(){"new"==i.value?e.removeAttribute("hidden"):e.setAttribute("hidden","true")}),t.addEventListener("click",u),document.addEventListener("DOMContentLoaded",n);