let i=document.getElementById("category"),e=document.getElementById("createcat"),l=document.getElementById("questionamount"),t=document.getElementById("addquestion"),m=document.getElementById("questions"),c,g,s=new Set,v=0,S=JSON;function n(){d(),r(),o()}function r(e=api_url+"/category/?approved=true&pending=true"){fetch(e).then(e=>e.json().then(e=>{var t=e.next,n=e.results;if(n){for(let t=0;t<n.length;t++){let e=document.createElement("option");e.value=n[t].Cid,e.innerText=n[t].Cname,i.appendChild(e)}null!=t&&r(t)}}))}function o(){url=api_url+"/questiontype/",fetch(url).then(e=>e.json().then(e=>{S=e}))}function d(){let e=document.getElementById("template");c=e.innerHTML,e.remove();let t=document.getElementById("templateanswer");g=t.innerHTML,t.remove()}function u(){v+=1,s.add(v);let e=document.createElement("div");e.id="q"+v.toString(),e.innerHTML=c,e.classList.add("border","row","col-lg-8","mx-auto","p-3"),m.appendChild(e);let t=document.getElementById("questionnumber"),n=document.getElementById("questionnumberfield"),u=document.getElementById("qtype"),i=document.getElementById("answeramount"),r=document.getElementById("answeramountfield"),o=document.getElementById("questiontext"),a=document.getElementById("answers"),d=document.getElementById("removequestion");t.innerText="Frage Nummer "+v.toString(),t.id="questionnumber"+v.toString(),t.name="questionnumber"+v.toString(),n.id="questionnumberfield"+v.toString(),n.name="questionnumberfield",n.value=v.toString();for(let t=0;t<S.length;t++){let e=document.createElement("option");e.value=S[t].QTname,e.innerText=S[t].QTdescription,u.appendChild(e)}u.id="qtype"+v.toString(),u.name="qtype"+v.toString(),u.addEventListener("change",function(){"single"==u.value||"multiple"==u.value?(i.removeAttribute("hidden"),r.value=i.value):(i.setAttribute("hidden","true"),r.value="1"),r.dispatchEvent(new Event("change"))}),i.id="answeramount"+v.toString(),"single"==u.value||"multiple"==u.value?(i.removeAttribute("hidden"),r.value=i.value):(i.setAttribute("hidden","true"),r.value="1"),i.addEventListener("change",function(){r.value=i.value,r.dispatchEvent(new Event("change"))}),r.addEventListener("change",function(){a.innerHTML="";var e=parseInt(r.value);for(let d=0;d<e;d++){let e=document.createElement("div");e.innerHTML=g,a.appendChild(e),e.id="question"+v.toString()+"answer"+d.toString(),e.classList.add("border","row","col-lg-10","mx-auto","p-3","rounded");let t=document.getElementById("answernumber"),n=document.getElementById("answernumberfield"),i=document.getElementById("answertext"),r=document.getElementById("correct"),o=document.getElementById("correctdiv");t.innerText="Antwort "+(d+1).toString(),t.id="question"+v.toString()+"answernumber"+d.toString(),n.id="question"+v.toString()+"answernumberfield"+d.toString(),n.name="question"+v.toString()+"answernumberfield"+d.toString(),n.value=d.toString(),i.id="question"+v.toString()+"answertext"+d.toString(),i.name="question"+v.toString()+"answertext"+d.toString(),o.id="question"+v.toString()+"correctdiv"+d.toString(),r.id="question"+v.toString()+"correct"+d.toString(),r.value=d.toString(),"multiple"==u.value?r.name="question"+v.toString()+"correct"+d.toString():"number_exact"==u.value|"number_deviation"==u.value?(r.name="question"+v.toString()+"correct",r.type="radio",r.setAttribute("checked","true"),o.setAttribute("hidden","true"),i.type="number"):(r.name="question"+v.toString()+"correct",r.type="radio")}}),a.id="answers"+v.toString(),r.dispatchEvent(new Event("change")),r.id="answeramountfield"+v.toString(),r.name="answeramountfield"+v.toString(),o.id="questiontext"+v.toString(),o.name="questiontext"+v.toString(),d.id="removequestion"+v.toString(),d.addEventListener("click",function(){s.delete(e.id.replace("q","")),l.value=s.size.toString(),e.remove()}),l.value=s.size.toString()}i.addEventListener("change",function(){"new"==i.value?e.removeAttribute("hidden"):e.setAttribute("hidden","true")}),t.addEventListener("click",u),document.addEventListener("DOMContentLoaded",n);