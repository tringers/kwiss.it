const e=5,t=50,n=10,d=124,c=2,l=30,m=document.getElementById("categorylist"),a=document.getElementById("categorySelects");let i=1,o=1,s={};function r(e=!1,t=!1){let n="?approved=true"+(e?"&pending=true":"");t&&(i=1,s={}),fetch(api_url+"/category/"+n+"&page=1").then(e=>e.json().then(e=>{o=Math.ceil(e.count/10),fetch(api_url+"/category/"+n+"&page="+i).then(e=>e.json().then(t=>{for(let e=0;e<t.results.length;e++){var n=t.results[e];void 0===s[n.Cname]&&(s[n.Cname]=n)}u(),h()}))}))}function u(){let n=Object.keys(s);for(let t=0;t<n.length;t++){var e=s[n[t]];void 0===e.Camount&&fetch(api_url+"/question/?cid="+e.Cid).then(e=>e.json().then(e=>{void 0===e||e===[]||e.length<=0?s[n[t]].Camount=0:s[n[t]].Camount=e.length,h()}))}}function h(){s=Object.keys(s).sort().reduce((e,t)=>(e[t]=s[t],e),{});let u=Object.keys(s);m.innerHTML="";for(let r=10*(i-1);r<Math.min(10*i,u.length);r++){let e=s[u[r]],t=document.createElement("tr"),n=document.createElement("td"),d=document.createElement("td"),c=document.createElement("td"),l=document.createElement("input");n.innerHTML=e.Cname,d.innerHTML=e.Camount,d.classList.add("text-center"),c.classList.add("selection-hover"),c.classList.add("text-center"),l.type="checkbox",l.name="categories",l.classList.add("form-check-input"),l.value=e.Cid.toString(),void 0===e.selected&&(e.selected=!1,s[u[r]].selected=!1),l.checked=e.selected,c.addEventListener("click",e=>{"input"!==e.path[0].localName&&(l.checked=!l.checked,s[u[r]].selected=l.checked,p())}),l.addEventListener("change",()=>{s[u[r]].selected=l.checked,p()}),c.appendChild(l),t.appendChild(n),t.appendChild(d),t.appendChild(c),m.appendChild(t);let a=document.createElement("tr"),i=document.createElement("td");a.hidden=!0,i.setAttribute("colspan","3"),i.innerText=e.Cdescription,a.appendChild(i),m.appendChild(a),n.addEventListener("click",e=>{a.hidden=!a.hidden}),d.addEventListener("click",e=>{a.hidden=!a.hidden});let o=document.createElement("tr");o.hidden=!0,m.appendChild(o)}}function p(){var n=Object.keys(s);a.innerHTML="";for(let t=0;t<n.length;t++){let e=document.createElement("input");e.value=s[n[t]].Cid.toString(),e.checked=s[n[t]].selected,a.appendChild(e)}}r(),document.getElementById("prev").addEventListener("click",()=>{i--,i<1&&(i=1),r()}),document.getElementById("next").addEventListener("click",()=>{i++,i>o&&(i=o),r()});let g=document.getElementById("lobbytype"),v=document.getElementById("lobbypasswordfield"),E=document.getElementById("lobbypasswordRaw"),y=document.getElementById("lobbypassword");function f(){v.hidden=!0}function C(){v.hidden=!1}async function L(e,t){let n=(new TextEncoder).encode(e);for(let e=0;e<t;e++){var d=await crypto.subtle.digest("SHA-256",n);n=Array.from(new Uint8Array(d))}return n.map(e=>e.toString(16).padStart(2,"0")).join("")}E.addEventListener("change",()=>{L(E.value,25e4).then(e=>{y.value=e})}),g.addEventListener("change",function(){"Ã–ffentlich"===g.value||"public"===g.value?f():"Privat"!==g.value&&"private"!==g.value||C()});let k=document.getElementById("questionamountslider"),b=document.getElementById("questionamountfield");w(k,b,e,t);let B=document.getElementById("timeamountslider"),I=document.getElementById("timeamountfield");w(B,I,n,d);let j=document.getElementById("playeramountslider"),M=document.getElementById("playeramountfield");function w(t,n,d,c){let e=function(e){e=Math.min(e,c),e=Math.max(e,d),t.value=e,n.value=e};t.addEventListener("change",()=>{e(t.value)}),n.addEventListener("change",()=>{e(n.value)})}w(j,M,c,l);let x=document.getElementById("pending");x.addEventListener("change",function(){x.checked?r(!0,!1):r(!1,!0)});