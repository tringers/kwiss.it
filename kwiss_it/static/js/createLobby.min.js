const e=5,t=50,n=10,d=124,l=2,c=30,m=document.getElementById("categorylist"),a=document.getElementById("categorySelects"),i=document.getElementById("lobbytype");let o=1,u=1,s={};function r(e=!1,t=!1){let n="?approved=true"+(e?"&pending=true":"");t&&(o=1,s={}),fetch(api_url+"/category/"+n+"&page=1").then(e=>e.json().then(e=>{u=Math.ceil(e.count/10),fetch(api_url+"/category/"+n+"&page="+o).then(e=>e.json().then(t=>{for(let e=0;e<t.results.length;e++){var n=t.results[e];void 0===s[n.Cname]&&(s[n.Cname]=n)}h(),g()}))}))}function h(){let n=Object.keys(s);for(let t=0;t<n.length;t++){var d=s[n[t]];let e=api_url+"/question/?cid="+d.Cid;"single"!=i.value&&"Single"!=i.value||(e+="&single=1"),void 0===d.Camount&&fetch(e).then(e=>e.json().then(e=>{void 0===e||e===[]||e.length<=0?s[n[t]].Camount=0:s[n[t]].Camount=e.length,g()}))}}function g(){s=Object.keys(s).sort().reduce((e,t)=>(e[t]=s[t],e),{});let r=Object.keys(s);m.innerHTML="";for(let u=10*(o-1);u<Math.min(10*o,r.length);u++){let e=s[r[u]],t=document.createElement("tr"),n=document.createElement("td"),d=document.createElement("td"),l=document.createElement("td"),c=document.createElement("input");n.innerHTML=e.Cname,d.innerHTML=e.Camount,d.classList.add("text-center"),l.classList.add("selection-hover"),l.classList.add("text-center"),c.type="checkbox",c.name="categories",c.classList.add("form-check-input"),c.value=e.Cid.toString(),void 0===e.selected&&(e.selected=!1,s[r[u]].selected=!1),c.checked=e.selected,l.addEventListener("click",e=>{"input"!==e.path[0].localName&&(c.checked=!c.checked,s[r[u]].selected=c.checked,p())}),c.addEventListener("change",()=>{s[r[u]].selected=c.checked,p()}),l.appendChild(c),t.appendChild(n),t.appendChild(d),t.appendChild(l),m.appendChild(t);let a=document.createElement("tr"),i=document.createElement("td");a.hidden=!0,i.setAttribute("colspan","3"),i.innerText=e.Cdescription,a.appendChild(i),m.appendChild(a),n.addEventListener("click",e=>{a.hidden=!a.hidden}),d.addEventListener("click",e=>{a.hidden=!a.hidden});let o=document.createElement("tr");o.hidden=!0,m.appendChild(o)}}function p(){var n=Object.keys(s);a.innerHTML="";for(let t=0;t<n.length;t++){let e=document.createElement("input");e.value=s[n[t]].Cid.toString(),e.checked=s[n[t]].selected,a.appendChild(e)}}r(),document.getElementById("prev").addEventListener("click",()=>{o--,o<1&&(o=1),r()}),document.getElementById("next").addEventListener("click",()=>{o++,o>u&&(o=u),r()});let v=document.getElementById("lobbypasswordfield"),y=document.getElementById("lobbypasswordRaw"),E=document.getElementById("lobbypassword"),f=document.getElementById("lobbynamefield"),b=document.getElementById("createlobbyname"),k=document.getElementById("playeramountfielddiv"),B=document.getElementById("gamerace"),C=document.getElementById("gamebasic");function I(){v.hidden=!0,f.hidden=!1,k.hidden=!1,B.removeAttribute("disabled")}function L(){v.hidden=!1,f.hidden=!1,k.hidden=!1,B.removeAttribute("disabled")}function j(){v.hidden=!0,f.hidden=!0,b.value="",k.setAttribute("hidden","true"),q.checked,h(),B.setAttribute("disabled","true"),C.checked=!0}async function A(e,t){let n=(new TextEncoder).encode(e);for(let e=0;e<t;e++){var d=await crypto.subtle.digest("SHA-256",n);n=Array.from(new Uint8Array(d))}return n.map(e=>e.toString(16).padStart(2,"0")).join("")}y.addEventListener("change",()=>{A(y.value,25e4).then(e=>{E.value=e})}),i.addEventListener("change",function(){"Ã–ffentlich"===i.value||"public"===i.value?I():"Privat"===i.value||"private"===i.value?L():"Single"!==i.value&&"single"!==i.value||j()});let M=document.getElementById("questionamountslider"),S=document.getElementById("questionamountfield");O(M,S,e,t);let w=document.getElementById("timeamountslider"),x=document.getElementById("timeamountfield");O(w,x,n,d);let T=document.getElementById("playeramountslider"),H=document.getElementById("playeramountfield");function O(t,n,d,l){let e=function(e){e=Math.min(e,l),e=Math.max(e,d),t.value=e,n.value=e};t.addEventListener("change",()=>{e(t.value)}),n.addEventListener("change",()=>{e(n.value)})}O(T,H,l,c);let q=document.getElementById("pending");q.addEventListener("change",function(){q.checked?r(!0,!1):r(!1,!0)});